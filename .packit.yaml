---
specfile_path: "oscap-anaconda-addon.spec"
upstream_ref: "r1.1.1"

actions:
  post-upstream-clone:
  - "wget https://src.fedoraproject.org/rpms/oscap-anaconda-addon/raw/rawhide/f/oscap-anaconda-addon.spec -O oscap-anaconda-addon.spec"
  # Different branches of the addon use different upstream releases as their base.
  - "sed -i 's/Version: .*/Version: 1.1.1/' oscap-anaconda-addon.spec"
  # use git_am instead of patch since packit patches are generated with git-format-patch
  - "sed -E -i 's/^%autosetup(.+)$/%autosetup -Sgit_am \\1/' oscap-anaconda-addon.spec"
  # which means, that we need git in the buildroot
  - "sed -i '23 a BuildRequires: git-core' oscap-anaconda-addon.spec"
  - "git add oscap-anaconda-addon.spec"
  - "git -c user.name=packit_integration -c user.email=noreply@fedoraproject.org commit -m 'apply rawhide specfile'"

patch_generation_ignore_paths:
- create_update_image.sh
